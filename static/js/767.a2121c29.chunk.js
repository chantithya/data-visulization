"use strict";(self.webpackChunkdata_visulization=self.webpackChunkdata_visulization||[]).push([[767],{767:(t,e,r)=>{r.d(e,{t1:()=>w});var o=r(43);const a=(t,e)=>{const{controls:r,toolbarItems:o,getChartEditor:a}=t;return e&&e.charts&&e.visualization&&e.visualization.ChartWrapper&&e.visualization.Dashboard&&(!r||e.visualization.ChartWrapper)&&(!a||e.visualization.ChartEditor)&&(!o||e.visualization.drawToolbar)};function n(t){const{chartVersion:e="current",chartPackages:r=["corechart","controls"],chartLanguage:n="en",mapsApiKey:l}=t,[s,i]=(0,o.useState)(null),[c,d]=(0,o.useState)(null),[u,g]=(0,o.useState)(null),{isLoading:p,error:h,isSuccess:m}=function(t){const[e,r]=(0,o.useState)(!0),[a,n]=(0,o.useState)(null),[l,s]=(0,o.useState)(!1),i=()=>{r(!1),s(!0)};return(0,o.useEffect)((()=>{if(!document){const e=new Error(`[ScriptLoadingError] document not defined when attempting to load ${t}`);return void n(e)}const e=document.querySelector(`script[src="${t}"]`);if(e?.dataset.loaded)return void i();const r=e||document.createElement("script");e||(r.src=t),r.addEventListener("load",(()=>{r.dataset.loaded="1",i()})),r.addEventListener("error",(e=>{console.error("Failed to load script:",t,e);const r=new Error(`[ScriptLoadingError] Failed to load script: ${t}`);n(r)})),e||document.head.append(r)}),[]),{isLoading:e,error:a,isSuccess:l}}(t.chartLoaderScriptUrl||"https://www.gstatic.com/charts/loader.js");return(0,o.useEffect)((()=>{if(!m)return;const o=window.google;if((t=>t&&t.charts)(o))a(t,o)?i(o):(o.charts.load(e,{packages:r,language:n,mapsApiKey:l}),o.charts.setOnLoadCallback((()=>{if(!a(t,o)){const t=new Error("[GoogleChartsInitializationError] Google Charts not ready after load callback.");return console.error(t),void g(t)}i(o)})));else{const t=new Error("[ScriptInitializationError] Script loaded but Google not attached to window.");d(t)}}),[m]),{error:h||c||u,isLoading:p,google:s}}const l={legend_toggle:!1,options:{},legendToggle:!1,getChartWrapper:()=>{},spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{},chartWrapperParams:{},chartLoaderScriptUrl:"https://www.gstatic.com/charts/loader.js"},s=t=>{const{isReady:e,chartControls:r,filter:a}=t;return e&&r&&r?.length?o.createElement(o.Fragment,null,r.filter((t=>{let{controlProp:e,control:r}=t;return!a||a({control:r,controlProp:e})})).map((t=>{let{control:e}=t;return o.createElement("div",{key:e.getContainerId(),id:e.getContainerId()})}))):null};let i=0;const c=()=>(i+=1,`reactgooglegraph-${i}`);class d{static initializeControls=t=>{for(let e=0;e<t.length;e+=1){const{controlType:r,options:o,controlWrapperParams:a}=t[e].controlProp;a&&"state"in a&&t[e].control.setState(a.state),t[e].control.setOptions(o),t[e].control.setControlType(r)}};static listenToControlEvents=(t,e)=>{const{google:r}=e;return t.flatMap((t=>{const{control:o,controlProp:a}=t,{controlEvents:n=[]}=a;return n.map((t=>{const{callback:a,eventName:n}=t;return r.visualization.events.addListener(o,n,(function(){for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];a({chartWrapper:null,controlWrapper:o,props:e,google:r,eventArgs:n})}))}))}))};static createControlId=t=>{let e;return e="undefined"===typeof t?`googlechart-control-${c()}`:t,e};static createChartControls=t=>{const{controls:e,google:r}=t;return e?e.map(((t,e)=>{const{controlID:o,controlType:a,options:n,controlWrapperParams:l}=t,s=this.createControlId(o);return{controlProp:t,control:new r.visualization.ControlWrapper({containerId:s,controlType:a,options:n,...l})}})):null};static addControls=t=>{const{chartWrapper:e,chartDashboard:r}=t,o=this.createChartControls(t);return o&&r&&e?(r.bind(o.map((t=>{let{control:e}=t;return e})),e),this.initializeControls(o),o):null}}const u=t=>{const[e,r]=(t=>{const[e,r]=o.useState(null);return[o.useMemo((()=>e&&t?t.map(((t,r)=>{const o=e[r];return o?{controlProp:t,control:o}:void 0})).flatMap((t=>t?[t]:[])):null),[e,t]),r]})(t.controls);((t,e)=>{o.useEffect((()=>{const r=d.listenToControlEvents(t??[],e);return()=>{r.forEach((t=>{e.google.visualization.events.removeListener(t)}))}}),[t,e])})(e??[],t);return{addControls:t=>{const e=d.addControls(t);r(e?.map((t=>t.control))??null)},renderControl:r=>{const{chartWrapper:a,chartDashboard:n}=t;return o.createElement(s,{...t,isReady:Boolean(a&&n),chartControls:e,filter:r})}}},g=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"];class p{static grayOutHiddenColumnsLabel=(t,e)=>{const{googleChartWrapper:r,options:o}=t;if(!r)return void console.error("googleChartWrapper is not defined");const a=r.getDataTable();if(!a)return;const n=a.getNumberOfColumns();if(!1===e.length>0)return;const l=Array.from({length:n-1}).map(((t,r)=>{const n=this.getColumnId(a,r+1);return e.includes(n)?"#CCCCCC":o&&o.colors?o.colors[r]:g[r]}));r.setOptions({...o,colors:l}),r.draw()};static listenToLegendToggle=(t,e)=>{const[r,o]=e,{google:a,googleChartWrapper:n}=t;if(n)return a.visualization.events.addListener(n,"select",(()=>{const t=n.getChart().getSelection(),e=n.getDataTable();if(0===t.length||null!==t[0].row||!e)return;const a=t[0].column,l=this.getColumnId(e,a);r?.includes(l)?o((t=>[...t.filter((t=>t!==l))])):o((t=>[...t,l]))}));console.error("googleChartWrapper is not defined")};static draw=async t=>{const{data:e,diffdata:r,rows:o,columns:a,options:n,chartType:l,formatters:s,spreadSheetUrl:i,spreadSheetQueryParameters:c,googleChartDashboard:d,googleChartWrapper:u,google:g,hiddenColumns:p,legendToggle:h,legend_toggle:m}=t;if(!u)return void console.error("draw was called with googleChartWrapper = null");let C,f=null;if(r){const t=g.visualization.arrayToDataTable(r.old),e=g.visualization.arrayToDataTable(r.new);f=g.visualization[l].prototype.computeDiff(t,e)}C=e?e instanceof g.visualization.DataTable?e:Array.isArray(e)?g.visualization.arrayToDataTable(e):new g.visualization.DataTable(e):o&&a?g.visualization.arrayToDataTable([a,...o]):i?await async function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((o,a)=>{const n=r.headers?`headers=${r.headers}`:"headers=0",l=r.query?`&tq=${encodeURIComponent(r.query)}`:"",s=r.gid?`&gid=${r.gid}`:"",i=r.sheet?`&sheet=${r.sheet}`:"",c=r.access_token?`&access_token=${r.access_token}`:"",d=`${e}/gviz/tq?${n}${s}${i}${l}${c}`;new t.visualization.Query(d).send((t=>{t.isError()?a(`Error in query:  ${t.getMessage()} ${t.getDetailedMessage()}`):o(t.getDataTable())}))}))}(g,i,c):g.visualization.arrayToDataTable([]);const v=C.getNumberOfColumns(),w=Array(v).fill(0).map(((t,e)=>{const r=this.getColumnId(C,e);return p.includes(r)?{label:C.getColumnLabel(e),type:C.getColumnType(e),calc:()=>null}:e})),y=u.getChart();"Timeline"===u.getChartType()&&y&&y.clearChart(),u.setChartType(l),u.setOptions(n||{});const b=new g.visualization.DataView(C);b.setColumns(w),u.setDataTable(b),u.draw(),d&&d.draw(C),f&&(u.setDataTable(f),u.draw()),s&&(this.applyFormatters({dataTable:C,formatters:s,google:g}),u.setDataTable(C),u.draw()),!0!==h&&!0!==m||this.grayOutHiddenColumnsLabel(t,p)};static getColumnId=(t,e)=>t.getColumnId(e)||t.getColumnLabel(e);static applyFormatters=t=>{let{dataTable:e,formatters:r,google:o}=t;for(let a of r)switch(a.type){case"ArrowFormat":return void new o.visualization.ArrowFormat(a.options).format(e,a.column);case"BarFormat":return void new o.visualization.BarFormat(a.options).format(e,a.column);case"ColorFormat":{const t=new o.visualization.ColorFormat(a.options),{ranges:r}=a;if(r)for(let e of r)t.addRange(...e);return void t.format(e,a.column)}case"DateFormat":return void new o.visualization.DateFormat(a.options).format(e,a.column);case"NumberFormat":return void new o.visualization.NumberFormat(a.options).format(e,a.column);case"PatternFormat":return void new o.visualization.PatternFormat(a.options).format(e,a.column);default:return void console.warn(`Unknown formatter type: ${a.type}`)}}}const h=t=>{(0,o.useEffect)((()=>{if(!t.googleChartWrapper)return;const e=(t=>{const{chartEvents:e,google:r,googleChartWrapper:o}=t;if(e){if(o)return e.map((e=>{let{eventName:a,callback:n}=e;return r.visualization.events.addListener(o,a,(function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];n({chartWrapper:o,props:t,google:r,eventArgs:a})}))}));console.warn("listenToEvents was called before chart wrapper ready.")}})(t);return()=>{e?.forEach((e=>{t.google.visualization.events.removeListener(e)}))}}),[t])},m=t=>{const[e,r]=o.useState(null),[a,n]=o.useState(null),{addControls:l,renderControl:s}=u({...t,chartDashboard:a,chartWrapper:e});h({...t,googleChartWrapper:e});const{chartId:i}=(t=>{const e=o.useRef(null);return{chartId:(()=>{const{graphID:r,graph_id:o}=t;let a;return a=r||o||e.current||c(),e.current=a,e.current})()}})(t),d=o.useRef(null),g=o.useRef(null);o.useEffect((()=>{const{options:e,google:o,chartType:a,chartWrapperParams:s,toolbarItems:c,getChartEditor:u,getChartWrapper:p,onLoad:h}=t,m={chartType:a,options:e,containerId:i,...s},C=new o.visualization.ChartWrapper(m);C.setOptions(e||{}),p?.(C,o);const f=new o.visualization.Dashboard(d.current);c&&o.visualization.drawToolbar(g.current,c);let v=null;u&&(v=new o.visualization.ChartEditor,u({chartEditor:v,chartWrapper:C,google:o})),l({...t,chartDashboard:f,chartWrapper:C}),r(C),n(f),h?.(o,{google:o,chartWrapper:C,chartEditor:v,chartDashboard:f})}),[]),(t=>{const{google:e,googleChartWrapper:r,googleChartDashboard:a}=t,[n,l]=o.useState([]);o.useEffect((()=>{r&&p.draw({...t,hiddenColumns:n,googleChartWrapper:r,googleChartDashboard:a,google:e})}),[n,t.data,t.rows,t.columns,t.options,t.chartLoaderScriptUrl,t.chartType,t.formatters,t.spreadSheetUrl,t.spreadSheetQueryParameters,t.legendToggle,t.legend_toggle]);const s=()=>{const{googleChartWrapper:e}=t;e&&e.draw()},i=r=>{const o=[],{legendToggle:i,legend_toggle:c}=t;if(p.draw({...t,hiddenColumns:n,googleChartWrapper:r,googleChartDashboard:a,google:e}),window.addEventListener("resize",s),c||i){const e=p.listenToLegendToggle(t,[n,l]);e&&o.push(e)}return o},c=(t,r)=>{window.removeEventListener("resize",s),r.forEach((t=>{e.visualization.events.removeListener(t)})),"Timeline"===t.getChartType()&&t.getChart()&&t.getChart().clearChart()};o.useEffect((()=>{if(!r)return;const t=i(r);return()=>{c(r,t)}}),[r,i,c])})({...t,googleChartWrapper:e,googleChartDashboard:a});const m=()=>{const{width:e,height:r,options:a,style:n,className:l,rootProps:s,google:c}=t,d={height:r||a&&a.height,width:e||a&&a.width,...n};return o.createElement("div",{id:i,style:d,className:l,...s})},C=()=>t.toolbarItems?o.createElement("div",{ref:g}):null,{width:f,height:v,options:w,style:y}=t,b={height:v||w&&w.height,width:f||w&&w.width,...y};return t.render?o.createElement("div",{ref:d,style:b},o.createElement("div",{ref:g,id:"toolbar"}),t.render({renderChart:m,renderControl:s,renderToolbar:C})):o.createElement("div",{ref:d,style:b},s((t=>{let{controlProp:e}=t;return"bottom"!==e.controlPosition})),m(),s((t=>{let{controlProp:e}=t;return"bottom"===e.controlPosition})),C())},C=o.createContext(l),f=t=>{let{children:e,value:r}=t;return o.createElement(C.Provider,{value:r},e)},v=t=>{const{google:e,isLoading:r,error:a}=n(t);return r?t.loader??null:a?t.errorElement??null:e?o.createElement(m,{google:e,...t}):null},w=t=>{const e={...l,...t};return o.createElement(f,{value:e},o.createElement(v,e))};var y;!function(t){t.annotation="annotation",t.annotationText="annotationText",t.certainty="certainty",t.emphasis="emphasis",t.interval="interval",t.scope="scope",t.style="style",t.tooltip="tooltip",t.domain="domain"}(y||(y={}))}}]);
//# sourceMappingURL=767.a2121c29.chunk.js.map